# 踩坑记录

开发过程中遇到的问题和解决方案，防止重复踩坑。

> **定位**：本文档是踩坑经验的汇总，遇到问题时立即记录，主文件见 @CLAUDE.md

## 记录格式

```markdown
### [日期] 问题简述
- **现象**：具体表现
- **原因**：根本原因
- **解决**：修复方法
- **预防**：如何避免再犯
```

---

## 代码类

### [2025-12-10] 前端页面 CSS 硬编码颜色
- **现象**：新页面在深色主题下显示异常，颜色与系统风格不一致
- **原因**：直接使用硬编码颜色值（如 `#ffffff`、`#333`）而非 CSS 变量
- **解决**：全面清理硬编码颜色，统一使用 CSS 变量（如 `var(--bg)`、`var(--text)`、`var(--border)`）
- **预防**：**开发新页面时，禁止使用硬编码颜色，必须使用 `index.css` 中定义的 CSS 变量**

### [2025-11-30] Codex 执行卡住无响应
- **现象**：`codex exec` 命令运行超过 30 分钟无输出
- **原因**：网络问题或 API 超时
- **解决**：使用 `KillShell` 终止后重试，或设置 timeout
- **预防**：对于简单分析任务，直接用 Claude 而非 Codex

### [模板] Shell 转义问题导致 Codex 失败
- **现象**：直接传递含特殊字符的 prompt 导致命令解析错误
- **原因**：Shell 对引号、换行等字符的转义处理
- **解决**：写入临时文件后用 `cat file | codex exec`
- **预防**：始终使用临时文件方式调用 Codex

---

## 配置类

### [模板] 环境变量未生效
- **现象**：修改 .env 后服务行为未变化
- **原因**：Docker 容器未重启 / 变量名拼写错误
- **解决**：`docker compose down && docker compose up -d`
- **预防**：修改配置后必须重启服务

---

## 部署类

### [模板] CI/CD 健康检查超时
- **现象**：GitHub Actions 部署失败，健康检查超时
- **原因**：服务启动慢 / 端口未开放 / 防火墙
- **解决**：增加等待时间，检查端口和防火墙
- **预防**：本地先测试 `curl http://localhost:8000/health`

---

## 快速添加记录

遇到问题解决后，立即按以下格式添加：

```markdown
### [YYYY-MM-DD] 问题简述
- **现象**：
- **原因**：
- **解决**：
- **预防**：
```

## 相关文档

- @CLAUDE.md - 主记忆文件（记忆更新规范）
- @docs/claude/debug-playbook.md - 调试排查手册
- @docs/claude/task-lifecycle.md - 任务执行流程（Codex 使用）
