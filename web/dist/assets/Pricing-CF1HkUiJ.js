import{r as l,j as e}from"./vendor-HVpYYIdB.js";import{C as y}from"./Card-B8iKcX7i.js";import{T as C}from"./Toast-D5AN34u6.js";import{c as m}from"./index-prwnWlNO.js";import"./charts-USIkmnH5.js";function $(){const[h,v]=l.useState([]),[u,p]=l.useState(!0),[x,j]=l.useState(null),[r,_]=l.useState(null),[N,o]=l.useState(!1),[t,a]=l.useState({model_id:"",model_name:"",input_price_mtok:0,output_price_mtok:0,is_active:!0}),i=(s,n="success")=>{j({message:s,type:n}),setTimeout(()=>j(null),2200)},c=async()=>{p(!0);try{const s=await m.getPricingList();v(s)}catch(s){i(s.message||"加载失败","error")}finally{p(!1)}};l.useEffect(()=>{c()},[]);const d=()=>{a({model_id:"",model_name:"",input_price_mtok:0,output_price_mtok:0,is_active:!0}),_(null),o(!1)},k=s=>{a({model_id:s.model_id,model_name:s.model_name,input_price_mtok:s.input_price_mtok,output_price_mtok:s.output_price_mtok,is_active:s.is_active}),_(s.model_id),o(!0)},g=async s=>{if(s.preventDefault(),!t.model_id.trim()){i("请输入模型 ID","error");return}try{await m.savePricing(t),i(r?"定价已更新":"定价已添加"),d(),c()}catch(n){i(n.message||"保存失败","error")}},f=async s=>{if(confirm(`确定要删除模型 "${s}" 的定价配置吗？`))try{await m.deletePricing(s),i("已删除"),c()}catch(n){i(n.message||"删除失败","error")}},b=s=>`$${s.toFixed(2)}`;return e.jsxs("div",{className:"pricing-page",children:[e.jsxs("div",{className:"pricing-header",children:[e.jsx("h1",{children:"模型定价"}),e.jsx("p",{className:"sub",children:"管理 Claude 模型的定价配置，用于计算 API 使用成本。"})]}),e.jsxs(y,{children:[e.jsxs("div",{className:"toolbar",children:[e.jsx("span",{className:"toolbar-title",children:"定价列表"}),e.jsx("div",{className:"spacer"}),e.jsx("button",{className:"btn ghost",type:"button",onClick:c,disabled:u,children:"刷新"}),e.jsx("button",{className:"btn primary",type:"button",onClick:()=>{d(),o(!0)},children:"添加定价"})]}),N&&e.jsxs("form",{className:"pricing-form",onSubmit:g,children:[e.jsxs("div",{className:"form-row",children:[e.jsxs("label",{children:[e.jsx("span",{className:"label-title",children:"模型 ID *"}),e.jsx("input",{type:"text",value:t.model_id,onChange:s=>a({...t,model_id:s.target.value}),placeholder:"claude-sonnet-4-5-20250929",disabled:!!r,required:!0})]}),e.jsxs("label",{children:[e.jsx("span",{className:"label-title",children:"显示名称"}),e.jsx("input",{type:"text",value:t.model_name,onChange:s=>a({...t,model_name:s.target.value}),placeholder:"Claude Sonnet 4.5"})]})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("label",{children:[e.jsx("span",{className:"label-title",children:"输入价格 ($/MTok)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.input_price_mtok,onChange:s=>a({...t,input_price_mtok:parseFloat(s.target.value)||0})})]}),e.jsxs("label",{children:[e.jsx("span",{className:"label-title",children:"输出价格 ($/MTok)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:t.output_price_mtok,onChange:s=>a({...t,output_price_mtok:parseFloat(s.target.value)||0})})]}),e.jsxs("label",{className:"checkbox-label",children:[e.jsx("input",{type:"checkbox",checked:t.is_active,onChange:s=>a({...t,is_active:s.target.checked})}),e.jsx("span",{children:"启用"})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{className:"btn ghost",type:"button",onClick:d,children:"取消"}),e.jsx("button",{className:"btn primary",type:"submit",children:r?"更新":"添加"})]})]}),u?e.jsx("div",{className:"loading-text",children:"加载中..."}):h.length===0?e.jsx("div",{className:"empty-text",children:"暂无定价配置"}):e.jsx("div",{className:"pricing-table-wrapper",children:e.jsxs("table",{className:"pricing-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"模型"}),e.jsx("th",{children:"输入价格"}),e.jsx("th",{children:"输出价格"}),e.jsx("th",{children:"状态"}),e.jsx("th",{children:"操作"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{className:s.is_active?"":"inactive",children:[e.jsx("td",{children:e.jsxs("div",{className:"model-info",children:[e.jsx("span",{className:"model-name",children:s.model_name}),e.jsx("span",{className:"model-id",children:s.model_id})]})}),e.jsxs("td",{className:"price-cell",children:[b(s.input_price_mtok),"/MTok"]}),e.jsxs("td",{className:"price-cell",children:[b(s.output_price_mtok),"/MTok"]}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.is_active?"active":"inactive"}`,children:s.is_active?"启用":"禁用"})}),e.jsxs("td",{className:"actions-cell",children:[e.jsx("button",{className:"btn-small ghost",onClick:()=>k(s),children:"编辑"}),e.jsx("button",{className:"btn-small danger",onClick:()=>f(s.model_id),children:"删除"})]})]},s.model_id))})]})}),e.jsx("div",{className:"notice",children:"价格单位：美元/百万 Token（MTok）。例如 $3.00/MTok 表示每处理 100 万个 Token 收费 3 美元。"})]}),e.jsx(C,{message:x?.message,type:x?.type})]})}export{$ as default};
