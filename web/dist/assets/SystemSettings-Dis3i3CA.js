import{r as t,j as e}from"./vendor-HVpYYIdB.js";import{C as l}from"./Card-B8iKcX7i.js";import{c as x}from"./index-BBaR1ozm.js";import"./charts-USIkmnH5.js";function b(){const[n,j]=t.useState([]),[u,v]=t.useState([]),[r,i]=t.useState(""),[g,d]=t.useState(!0),[c,o]=t.useState("");t.useEffect(()=>{(async()=>{try{const a=await x.getEnvVarCategories();j(a),a.length>0&&i(a[0].key)}catch(a){console.error("Failed to load categories:",a)}})()},[]),t.useEffect(()=>{if(!r)return;(async()=>{d(!0);try{const a=await x.getEnvVars(r);v(a)}catch(a){console.error("Failed to load env vars:",a)}finally{d(!1)}})()},[r]);const h=u.filter(s=>{if(!c)return!0;const a=c.toLowerCase();return s.name.toLowerCase().includes(a)||s.description.toLowerCase().includes(a)||s.current_value.toLowerCase().includes(a)}),m=n.find(s=>s.key===r);return e.jsxs("div",{className:"system-settings-page",children:[e.jsxs("div",{className:"system-settings-header",children:[e.jsx("h1",{children:"环境变量配置"}),e.jsx("p",{className:"sub",children:"查看当前系统的环境变量配置。这些值在服务启动时读取，修改需重启服务生效。"})]}),e.jsx(l,{className:"settings-card tabs-card",children:e.jsxs("div",{className:"settings-toolbar",children:[e.jsx("div",{className:"tab-group",children:n.map(s=>e.jsx("button",{type:"button",className:`tab-btn ${r===s.key?"active":""}`,onClick:()=>i(s.key),title:s.description,children:s.label},s.key))}),e.jsx("div",{className:"spacer"}),e.jsxs("div",{className:"search-box",children:[e.jsx("input",{type:"text",placeholder:"搜索变量名或说明...",value:c,onChange:s=>o(s.target.value)}),c&&e.jsx("button",{className:"clear-btn",onClick:()=>o(""),children:"×"})]})]})}),m&&e.jsx("div",{className:"category-description",children:m.description}),e.jsx(l,{className:"settings-card",children:e.jsx("div",{className:"envvar-table-container",children:g?e.jsx("div",{className:"settings-loading",children:"加载中..."}):h.length===0?e.jsx("div",{className:"no-settings",children:c?"没有匹配的环境变量":"该分类暂无环境变量"}):e.jsxs("table",{className:"envvar-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"col-name",children:"变量名"}),e.jsx("th",{className:"col-value",children:"当前值"}),e.jsx("th",{className:"col-default",children:"默认值"}),e.jsx("th",{className:"col-desc",children:"说明"})]})}),e.jsx("tbody",{children:h.map(s=>e.jsxs("tr",{className:s.is_set?"is-set":"",children:[e.jsxs("td",{className:"col-name",children:[e.jsx("code",{className:"envvar-name",children:s.name}),s.is_set&&e.jsx("span",{className:"set-badge",children:"已设置"})]}),e.jsx("td",{className:"col-value",children:s.is_secret?e.jsx("span",{className:"secret-value",children:s.current_value||"(未设置)"}):e.jsx("code",{className:`envvar-value ${s.current_value?"":"empty"}`,children:s.current_value||"(空)"})}),e.jsx("td",{className:"col-default",children:e.jsx("code",{className:`default-value ${s.default_value?"":"empty"}`,children:s.default_value||"(无)"})}),e.jsx("td",{className:"col-desc",children:e.jsx("span",{className:"envvar-desc",children:s.description})})]},s.name))})]})})}),e.jsx(l,{className:"settings-card info-card",children:e.jsxs("div",{className:"info-section",children:[e.jsx("h3",{children:"使用说明"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"修改环境变量"}),"：编辑 ",e.jsx("code",{children:".env"})," 文件或在 Docker Compose 中设置，然后重启服务"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"敏感值"}),"：API Key 等敏感信息会脱敏显示（仅显示首尾各 4 位）"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"已设置标记"}),"：表示该变量已在环境中显式设置，非使用默认值"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"优先级"}),"：环境变量 > 配置文件 > 默认值"]})]})]})})]})}export{b as default};
