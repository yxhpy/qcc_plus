const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-jXCUqavv.js","assets/vendor-HVpYYIdB.js","assets/charts-USIkmnH5.js","assets/Toast-BukLN0_W.js","assets/Toast-BX5cqTP9.css","assets/Login-B-p3Jo6y.css","assets/Dashboard-DjRWEo2W.js","assets/Card-Bmh2bB8_.js","assets/Card-DD-Y4krM.css","assets/date-DeDlRUHn.js","assets/Dashboard-GGiX7z4_.css","assets/Accounts-BY28lqtQ.js","assets/useDialog-CfRkIH_r.js","assets/useDialog-ixuzfewQ.css","assets/Accounts-DKljLY4O.css","assets/Nodes-BiAkwejC.js","assets/Nodes-C6ogmEE2.css","assets/Monitor-lBYp0Dmv.js","assets/useMonitorWebSocket-DjonRZ55.js","assets/useMonitorWebSocket-DmZyvyKm.css","assets/Monitor-B6OEkv1X.css","assets/MonitorShares-CYNRVH3m.js","assets/MonitorShares-CSqsVlyo.css","assets/Settings-UzuPKq99.js","assets/Settings-FS8Ddjzu.css","assets/SystemSettings-yELA6wPX.js","assets/SystemSettings-CS6mSA-U.css","assets/TunnelSettings-DVVY_-Bz.js","assets/TunnelSettings-CJtnrcW4.css","assets/Notifications-CHGZDlTl.js","assets/Notifications-P5e6ynuS.css","assets/ChangelogPage-DNAbPC3x.js","assets/ChangelogPage-Cl_PUTOa.css","assets/SharedMonitor-WqbkmKD8.js","assets/SharedMonitor-DMSlU3_D.css","assets/ClaudeConfig-C7WHui4Z.js","assets/ClaudeConfig-gSafHraR.css"])))=>i.map(i=>d[i]);
import{r as i,j as t,u as ee,L as te,N as ne,B as re,R as oe,a as y,b as O,c as se}from"./vendor-HVpYYIdB.js";import"./charts-USIkmnH5.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();const ae="modulepreload",ie=function(e){return"/"+e},D={},j=function(n,r,c){let s=Promise.resolve();if(r&&r.length>0){let u=function(p){return Promise.all(p.map(x=>Promise.resolve(x).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),h=d?.nonce||d?.getAttribute("nonce");s=u(r.map(p=>{if(p=ie(p),p in D)return;D[p]=!0;const x=p.endsWith(".css"),_=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${_}`))return;const m=document.createElement("link");if(m.rel=x?"stylesheet":ae,x||(m.as="script"),m.crossOrigin="",m.href=p,h&&m.setAttribute("nonce",h),document.head.appendChild(m),x)return new Promise((v,b)=>{m.addEventListener("load",v),m.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(d){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=d,window.dispatchEvent(h),!h.defaultPrevented)throw d}return s.then(d=>{for(const h of d||[])h.status==="rejected"&&a(h.reason);return n().catch(a)})},f={"Content-Type":"application/json"};async function ce(e){const n=e.headers.get("content-type")||"";if(e.redirected||e.url.includes("/login"))throw new Error("unauthenticated");const r=await e.text();if(!n.includes("application/json"))throw new Error(r||"unexpected response");try{return JSON.parse(r)}catch{throw new Error("invalid json response")}}async function l(e,n={}){const r=await fetch(e,{credentials:"include",...n});if(!r.ok){let c=r.statusText;try{const s=await r.json();c=s.error||s.message||c}catch{}throw new Error(c||"request failed")}if(r.status!==204)return ce(r)}async function de(e,n){const r=new URLSearchParams({username:e,password:n});if(!(await fetch("/login",{method:"POST",body:r,credentials:"include",redirect:"follow"})).ok)throw new Error("登录失败");try{await W()}catch{throw new Error("账号名称或密码错误")}}async function le(){await fetch("/logout",{method:"POST",credentials:"include",redirect:"follow"})}async function W(){return(await l("/admin/api/accounts")).accounts||[]}async function ue(e){return(await l("/admin/api/accounts",{method:"POST",headers:f,body:JSON.stringify(e)})).id}async function he(e,n){await l(`/admin/api/accounts?id=${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify(n)})}async function pe(e){await l(`/admin/api/accounts?id=${encodeURIComponent(e)}`,{method:"DELETE"})}function N(e,n){if(!n)return e;const r=e.includes("?")?"&":"?";return`${e}${r}account_id=${encodeURIComponent(n)}`}async function ge(e){return(await l(N("/admin/api/nodes",e))).nodes||[]}async function me(e,n){return(await l(N("/admin/api/nodes",n),{method:"POST",headers:f,body:JSON.stringify(e)})).id}async function fe(e,n){await l(`/admin/api/nodes?id=${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify(n)})}async function xe(e){await l(`/admin/api/nodes?id=${encodeURIComponent(e)}`,{method:"DELETE"})}async function ye(e){await l("/admin/api/nodes/activate",{method:"POST",headers:f,body:JSON.stringify({id:e})})}async function je(e,n){await l(n?"/admin/api/nodes/enable":"/admin/api/nodes/disable",{method:"POST",headers:f,body:JSON.stringify({id:e})})}async function ve(e){const n=N("/api/monitor/dashboard",e);return l(n)}async function be(e,n,r,c,s){const a=new URLSearchParams;n&&a.set("from",n),r&&a.set("to",r),c&&a.set("share_token",c),s&&a.set("source",s);const d=a.toString(),h=d?`/api/nodes/${encodeURIComponent(e)}/health-history?${d}`:`/api/nodes/${encodeURIComponent(e)}/health-history`;return l(h)}async function we(e){const n=await l("/api/monitor/shares",{method:"POST",headers:f,body:JSON.stringify(e)});return{id:n.id,token:n.token,share_url:n.share_url,expire_at:n.expire_at??void 0,created_at:n.created_at,account_id:n.account_id||e.account_id||"",created_by:n.created_by||"",revoked:!1,revoked_at:void 0}}async function Ee(e,n=20,r=0){const c=new URLSearchParams;e&&c.set("account_id",e),c.set("limit",String(n)),c.set("offset",String(r));const s=c.toString(),a=s?`/api/monitor/shares?${s}`:"/api/monitor/shares",d=await l(a);return{shares:d.shares||[],total:d.total}}async function Pe(e){await l(`/api/monitor/shares/${encodeURIComponent(e)}`,{method:"DELETE"})}async function Se(e){return l(`/api/monitor/share/${encodeURIComponent(e)}`)}async function _e(e){return l(N("/admin/api/config",e))}async function ke(e,n){await l(N("/admin/api/config",n),{method:"PUT",headers:f,body:JSON.stringify(e)})}async function Ce(){return l("/admin/api/tunnel")}async function Le(e){return l("/admin/api/tunnel",{method:"PUT",headers:f,body:JSON.stringify(e)})}async function Fe(){return l("/admin/api/tunnel/start",{method:"POST",headers:f})}async function Ne(){return l("/admin/api/tunnel/stop",{method:"POST",headers:f})}async function Te(){return(await l("/admin/api/tunnel/zones")).zones||[]}async function Ae(){return l("/version")}async function Oe(){const e=await fetch("/changelog",{credentials:"include"}),n=await e.text();if(e.redirected||e.url.includes("/login"))throw new Error("unauthenticated");if(!e.ok)throw new Error(n||"加载更新日志失败");return n}async function Re(){try{const e=await l("/api/notification/channels");return Array.isArray(e?.channels)?e.channels:[]}catch(e){return console.error("Failed to fetch notification channels:",e),[]}}async function Me(e){return l("/api/notification/channels",{method:"POST",headers:f,body:JSON.stringify(e)})}async function Be(e,n){await l(`/api/notification/channels/${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify(n)})}async function Ie(e){await l(`/api/notification/channels/${encodeURIComponent(e)}`,{method:"DELETE"})}async function De(e){const n=e?`/api/notification/subscriptions?channel_id=${encodeURIComponent(e)}`:"/api/notification/subscriptions";try{const r=await l(n);return Array.isArray(r?.subscriptions)?r.subscriptions:[]}catch(r){return console.error("Failed to fetch subscriptions:",r),[]}}async function Ue(e){await l("/api/notification/subscriptions",{method:"POST",headers:f,body:JSON.stringify(e)})}async function $e(e,n){await l(`/api/notification/subscriptions/${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify({enabled:n})})}async function Ve(e){await l(`/api/notification/subscriptions/${encodeURIComponent(e)}`,{method:"DELETE"})}async function Je(){try{const e=await l("/api/notification/event-types");return Array.isArray(e?.event_types)?e.event_types:[]}catch(e){return console.error("Failed to fetch event types:",e),[]}}async function We(e){await l("/api/notification/test",{method:"POST",headers:f,body:JSON.stringify(e)})}async function ze(e){const n=new URLSearchParams;e?.proxy_url&&n.set("proxy_url",e.proxy_url),e?.api_key&&n.set("api_key",e.api_key),e?.model&&n.set("model",e.model),e?.allow?.forEach(s=>{const a=s.trim();a&&n.append("allow",a)}),e?.deny?.forEach(s=>{const a=s.trim();a&&n.append("deny",a)});const r=n.toString(),c=r?`/api/claude-config/template?${r}`:"/api/claude-config/template";return l(c)}const A={login:de,logout:le,getAccounts:W,createAccount:ue,updateAccount:he,deleteAccount:pe,getNodes:ge,createNode:me,updateNode:fe,deleteNode:xe,activateNode:ye,toggleNode:je,getMonitorDashboard:ve,getHealthHistory:be,createMonitorShare:we,getMonitorShares:Ee,revokeMonitorShare:Pe,getSharedMonitor:Se,getConfig:_e,updateConfig:ke,getTunnel:Ce,saveTunnel:Le,startTunnel:Fe,stopTunnel:Ne,listZones:Te,getVersion:Ae,getChangelog:Oe,getNotificationChannels:Re,createNotificationChannel:Me,updateNotificationChannel:Be,deleteNotificationChannel:Ie,getNotificationSubscriptions:De,createNotificationSubscriptions:Ue,updateNotificationSubscription:$e,deleteNotificationSubscription:Ve,getEventTypes:Je,testNotification:We,getClaudeConfigTemplate:ze},z=i.createContext(void 0),T="claude-proxy-auth";function He({children:e}){const[n,r]=i.useState(null),[c,s]=i.useState(!0),a=i.useCallback(async()=>{s(!0);try{const x=(await A.getAccounts())[0]||null;r(x),x?localStorage.setItem(T,"true"):localStorage.removeItem(T)}catch{r(null),localStorage.removeItem(T)}finally{s(!1)}},[]);i.useEffect(()=>{a()},[a]);const d=i.useCallback(async(p,x)=>{await A.login(p,x),await a()},[a]),h=i.useCallback(async()=>{await A.logout(),localStorage.removeItem(T),r(null)},[]),u=i.useMemo(()=>({user:n,loading:c,isAuthenticated:!!n,isAdmin:!!n?.is_admin,login:d,logout:h,refresh:a}),[n,c,d,h,a]);return t.jsx(z.Provider,{value:u,children:e})}function I(){const e=i.useContext(z);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function qe(){const[e,n]=i.useState(null),[r,c]=i.useState(!0),[s,a]=i.useState(null);return i.useEffect(()=>{let d=!1;return(async()=>{c(!0),a(null);try{const u=await A.getVersion();d||n(u)}catch(u){d||a(u instanceof Error?u:new Error("加载版本信息失败"))}finally{d||c(!1)}})(),()=>{d=!0}},[]),{version:e,loading:r,error:s}}const Ze={50:"#F8FAFC",100:"#F1F5F9",200:"#E2E8F0",300:"#CBD5E1",400:"#94A3B8",500:"#64748B",600:"#475569",700:"#334155",800:"#1E293B",900:"#0F172A"},H={50:"#EFF6FF",100:"#DBEAFE",200:"#BFDBFE",300:"#93C5FD",400:"#60A5FA",500:"#3B82F6",600:"#2563EB",700:"#1D4ED8",800:"#1E40AF",900:"#1E3A8A"},Ke={50:"#ECFDF3",100:"#D1FADF",200:"#A6F4C5",700:"#027A48",900:"#054F31"},Qe={50:"#FFFBEB",100:"#FEF3C7",200:"#FDE68A",700:"#B45309",900:"#78350F"},Ye={50:"#FEF2F2",100:"#FEE2E2",200:"#FECACA",700:"#B91C1C",900:"#7F1D1D"},Ge={...H},o={colorPalette:{gray:Ze,primary:H,success:Ke,warning:Qe,danger:Ye,info:Ge},typography:{fontSize:{base:"14px"},fontWeight:{semibold:600}},spacing:{2:"8px",3:"12px",4:"16px"},radius:{md:"4px",lg:"6px"},shadow:{none:"none",sm:"0 1px 2px rgba(15, 23, 42, 0.08), 0 1px 1px rgba(15, 23, 42, 0.04)",md:"0 4px 8px rgba(15, 23, 42, 0.12), 0 2px 4px rgba(15, 23, 42, 0.08)",lg:"0 12px 24px rgba(15, 23, 42, 0.16), 0 6px 12px rgba(15, 23, 42, 0.12)"},transition:{duration:{normal:"200ms"}},easing:{easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)"}},R=e=>`0 0 0 3px ${e}`,q=(e,n)=>{const r=n==="light",c={bg:o.colorPalette.primary[600],text:"#FFFFFF",border:o.colorPalette.primary[600],hoverBg:o.colorPalette.primary[700],activeBg:o.colorPalette.primary[800],disabledBg:r?o.colorPalette.gray[200]:o.colorPalette.gray[800],disabledText:e.text.disabled,focusRing:R(e.interaction.focus)},s={bg:e.bg.card,text:e.text.primary,border:e.border.default,hoverBg:r?o.colorPalette.gray[100]:"rgba(255, 255, 255, 0.04)",activeBg:r?o.colorPalette.gray[200]:"rgba(255, 255, 255, 0.08)",disabledBg:r?o.colorPalette.gray[100]:o.colorPalette.gray[800],disabledText:e.text.disabled,focusRing:R(e.interaction.focus)},a={bg:"transparent",text:o.colorPalette.primary[600],border:"transparent",hoverBg:r?o.colorPalette.primary[50]:"rgba(59, 130, 246, 0.12)",activeBg:r?o.colorPalette.primary[100]:"rgba(59, 130, 246, 0.16)",disabledBg:"transparent",disabledText:e.text.disabled,focusRing:R(e.interaction.focus)};return{button:{height:"40px",paddingX:o.spacing[3],paddingY:o.spacing[2],gap:o.spacing[2],radius:o.radius.md,typography:{size:o.typography.fontSize.base,weight:o.typography.fontWeight.semibold},variants:{primary:c,secondary:s,ghost:a},transition:{duration:o.transition.duration.normal,easing:o.easing.easeInOut}},card:{bg:e.bg.card,text:e.text.primary,border:e.border.default,shadow:r?o.shadow.sm:o.shadow.md,radius:o.radius.lg,padding:o.spacing[4],elevated:{bg:e.bg.elevated,shadow:r?o.shadow.md:o.shadow.lg}},sidebar:{width:{collapsed:"72px",expanded:"256px"},bg:r?"#FFFFFF":o.colorPalette.gray[900],text:e.text.primary,border:e.border.default,activeItemBg:r?o.colorPalette.primary[50]:"rgba(59, 130, 246, 0.16)",activeItemText:r?o.colorPalette.primary[700]:"#FFFFFF"},table:{headerBg:e.bg.elevated,headerText:e.text.secondary,rowHoverBg:e.interaction.hover,rowActiveBg:e.interaction.active,border:e.border.default,divider:e.divider,radius:o.radius.md,padding:o.spacing[3]},input:{bg:e.bg.card,text:e.text.primary,placeholder:e.text.muted,border:e.border.default,hoverBorder:e.border.default,focusBorder:e.border.focus,disabledBg:r?o.colorPalette.gray[100]:o.colorPalette.gray[800],disabledText:e.text.disabled,radius:o.radius.md,shadow:r?o.shadow.sm:o.shadow.none}}},Xe="rgba(15, 23, 42, 0.48)",et="rgba(0, 0, 0, 0.55)",C=(e,n)=>n==="light"?{bg:e[50],text:e[700],border:e[200]}:{bg:e[900],text:e[100],border:e[700]},tt={text:{primary:o.colorPalette.gray[900],secondary:o.colorPalette.gray[700],muted:o.colorPalette.gray[500],disabled:o.colorPalette.gray[400],inverse:"#FFFFFF"},bg:{page:o.colorPalette.gray[50],card:"#FFFFFF",elevated:"#FFFFFF",overlay:Xe},state:{success:C(o.colorPalette.success,"light"),info:C(o.colorPalette.info,"light"),warning:C(o.colorPalette.warning,"light"),danger:C(o.colorPalette.danger,"light")},interaction:{hover:o.colorPalette.primary[50],active:o.colorPalette.primary[100],focus:o.colorPalette.primary[300]},divider:o.colorPalette.gray[200],border:{default:o.colorPalette.gray[300],focus:o.colorPalette.primary[500]}},nt={text:{primary:o.colorPalette.gray[50],secondary:o.colorPalette.gray[300],muted:o.colorPalette.gray[500],disabled:o.colorPalette.gray[600],inverse:o.colorPalette.gray[900]},bg:{page:"#0B1220",card:"#0F172A",elevated:"#111827",overlay:et},state:{success:C(o.colorPalette.success,"dark"),info:C(o.colorPalette.info,"dark"),warning:C(o.colorPalette.warning,"dark"),danger:C(o.colorPalette.danger,"dark")},interaction:{hover:"rgba(59, 130, 246, 0.12)",active:"rgba(59, 130, 246, 0.18)",focus:o.colorPalette.primary[400]},divider:o.colorPalette.gray[700],border:{default:o.colorPalette.gray[700],focus:o.colorPalette.primary[400]}};q(tt,"light");q(nt,"dark");const Z=i.createContext(void 0),U="qcc-theme";function $(){return typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function rt({children:e}){const[n,r]=i.useState(()=>{if(typeof window<"u"){const d=localStorage.getItem(U);if(d&&["light","dark","system"].includes(d))return d}return"system"}),[c,s]=i.useState(()=>n==="system"?$():n);i.useEffect(()=>{if(n!=="system")return;const d=window.matchMedia("(prefers-color-scheme: dark)"),h=u=>{s(u.matches?"dark":"light")};return d.addEventListener("change",h),()=>d.removeEventListener("change",h)},[n]),i.useEffect(()=>{s(n==="system"?$():n)},[n]),i.useEffect(()=>{document.documentElement.setAttribute("data-theme",c)},[c]);const a=i.useCallback(d=>{r(d),localStorage.setItem(U,d)},[]);return t.jsx(Z.Provider,{value:{theme:n,resolvedTheme:c,setTheme:a},children:e})}function ot(){const e=i.useContext(Z);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e}const k={dashboard:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1.2"}),t.jsx("rect",{x:"11",y:"3",width:"6",height:"4.5",rx:"1.2"}),t.jsx("rect",{x:"3",y:"11",width:"6",height:"6",rx:"1.2"}),t.jsx("rect",{x:"11",y:"9.5",width:"6",height:"7.5",rx:"1.2"})]}),monitor:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("rect",{x:"2.75",y:"3.5",width:"14.5",height:"9.5",rx:"1.3"}),t.jsx("path",{d:"M5.5 11.5 7.3 8l1.9 4 1.6-4.7 1.8 4.6 1.4-3"}),t.jsx("path",{d:"M8 16.5h4"}),t.jsx("path",{d:"M10 13v3.5"})]}),magic:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"m11 2.5-4.8 7.7h3.2L7.8 17.5l6.2-9.7H11l.8-5.3Z"}),t.jsx("path",{d:"m4 15.6 2-2"}),t.jsx("path",{d:"m14.5 5.5 1.5-1.5"}),t.jsx("path",{d:"m5.2 5.8.6-2.3"}),t.jsx("path",{d:"m15 14.2 1.8.3"})]}),accounts:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M10 10.25a3.25 3.25 0 1 0-3.25-3.25A3.25 3.25 0 0 0 10 10.25Z"}),t.jsx("path",{d:"M4.5 15.75c.8-2.05 2.85-3.25 5.5-3.25s4.7 1.2 5.5 3.25"})]}),nodes:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"5",cy:"5",r:"2.25"}),t.jsx("circle",{cx:"15",cy:"6.5",r:"2.25"}),t.jsx("circle",{cx:"10",cy:"15",r:"2.25"}),t.jsx("path",{d:"M6.9 6.1 13.2 6.4"}),t.jsx("path",{d:"M6.2 6.9 8.8 13.4"}),t.jsx("path",{d:"M13.3 8.4 10.9 13"})]}),share:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"m15.5 5-5.2 3-5.3-3"}),t.jsx("circle",{cx:"15.5",cy:"5",r:"2"}),t.jsx("circle",{cx:"4.5",cy:"10",r:"2"}),t.jsx("circle",{cx:"15.5",cy:"15",r:"2"}),t.jsx("path",{d:"m6.4 11.1 3.9 2.3"}),t.jsx("path",{d:"m11 7.9 3.6 1.9"})]}),settings:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"10",cy:"10",r:"3"}),t.jsx("path",{d:"M10 3.5v1.2"}),t.jsx("path",{d:"M10 15.3v1.2"}),t.jsx("path",{d:"m4.3 5.2.9.7"}),t.jsx("path",{d:"m14.8 14.1.9.7"}),t.jsx("path",{d:"M3.5 10h1.2"}),t.jsx("path",{d:"M15.3 10h1.2"}),t.jsx("path",{d:"m4.3 14.8.9-.7"}),t.jsx("path",{d:"m14.8 5.9.9-.7"})]}),notifications:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M6.5 8.5a3.5 3.5 0 0 1 7 0c0 3.25 1.15 4.5 2 5H4.5c.85-.5 2-1.75 2-5Z"}),t.jsx("path",{d:"M9 15.5c.25.6.85 1 1.5 1s1.25-.4 1.5-1"})]}),tunnel:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M6.2 11.5A3.5 3.5 0 0 1 6.5 4a3.7 3.7 0 0 1 1.9.52 4 4 0 0 1 6 3.48v.5a3 3 0 0 1-1.2 5.8H11"}),t.jsx("path",{d:"M11.2 9.5 8.8 12l2.4 2.5"})]}),changelog:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M6.5 3.5h5.8a1.7 1.7 0 0 1 1.2.5l2 2a1.7 1.7 0 0 1 .5 1.2v7.1a1.7 1.7 0 0 1-1.7 1.7H6.5A1.7 1.7 0 0 1 4.8 14V5.2A1.7 1.7 0 0 1 6.5 3.5Z"}),t.jsx("path",{d:"M13 3.6V6a1 1 0 0 0 1 1h2.3"}),t.jsx("path",{d:"M7.5 9.5h5"}),t.jsx("path",{d:"M7.5 12.5h3.5"})]}),collapse:t.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"m11.5 5.5-4 4 4 4"})}),expand:t.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"m8.5 14.5 4-4-4-4"})}),logout:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M11.5 5.5V4.2A1.7 1.7 0 0 0 9.8 2.5H5.7A1.7 1.7 0 0 0 4 4.2v11.6a1.7 1.7 0 0 0 1.7 1.7h4.1a1.7 1.7 0 0 0 1.7-1.7v-1.3"}),t.jsx("path",{d:"M8.5 10h7"}),t.jsx("path",{d:"m13.5 7 3 3-3 3"})]}),sun:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"10",cy:"10",r:"3.25"}),t.jsx("path",{d:"M10 3.5v1.5M10 15v1.5M4.5 10H3M17 10h-1.5M5.5 5.5 4.4 4.4M15.6 15.6 14.5 14.5M5.5 14.5 4.4 15.6M15.6 4.4 14.5 5.5"})]}),moon:t.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M15.5 11.6a5.8 5.8 0 1 1-7.1-7.1 5.2 5.2 0 0 0 7.1 7.1Z"})}),system:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"10",cy:"10",r:"5.5"}),t.jsx("path",{d:"M4.5 10h11"}),t.jsx("path",{d:"M10 4.5c1.6 2.6 1.6 8.4 0 11"})]})},V=[{path:"/admin/dashboard",label:"仪表盘",icon:"dashboard",group:"core"},{path:"/admin/claude-config",label:"快速配置",icon:"magic",group:"core"},{path:"/admin/monitor",label:"监控大屏",icon:"monitor",group:"core"},{path:"/admin/nodes",label:"节点管理",icon:"nodes",group:"core"},{path:"/admin/accounts",label:"账号管理",icon:"accounts",adminOnly:!0,group:"system"},{path:"/admin/monitor-shares",label:"分享链接",icon:"share",group:"system"},{path:"/admin/notifications",label:"通知管理",icon:"notifications",group:"system"},{path:"/settings",label:"系统设置",icon:"settings",adminOnly:!0,group:"system"},{path:"/admin/tunnel",label:"隧道设置",icon:"tunnel",adminOnly:!0,group:"system"}],J="qcc-sidebar-collapsed";function E({children:e}){const{logout:n,user:r}=I(),{version:c}=qe(),{theme:s,setTheme:a,resolvedTheme:d}=ot(),h=ee(),[u,p]=i.useState(()=>typeof window>"u"?!1:localStorage.getItem(J)==="true");i.useEffect(()=>{const g=window.matchMedia("(max-width: 768px)"),w=X=>{X.matches&&p(!0)};return g.matches&&p(!0),g.addEventListener?g.addEventListener("change",w):g.addListener(w),()=>{g.removeEventListener?g.removeEventListener("change",w):g.removeListener(w)}},[]);const x=i.useCallback(()=>{p(g=>{const w=!g;return localStorage.setItem(J,String(w)),w})},[]),_=async()=>{try{await n(),h("/login",{replace:!0})}catch{h("/login",{replace:!0})}},m=()=>{const g=["light","dark","system"],w=g.indexOf(s);a(g[(w+1)%g.length])},v=V.filter(g=>g.group==="core"),b=V.filter(g=>g.group==="system"),S=g=>g.adminOnly&&!r?.is_admin?null:t.jsxs(ne,{to:g.path,className:({isActive:w})=>`sidebar-link ${w?"active":""}`,title:u?g.label:void 0,children:[t.jsx("span",{className:"sidebar-icon",children:k[g.icon]}),!u&&t.jsx("span",{className:"sidebar-label",children:g.label})]},g.path),L=s==="system"?k.system:d==="dark"?k.moon:k.sun,G=s==="system"?"跟随系统":d==="dark"?"深色":"浅色";return t.jsxs("div",{className:`layout ${u?"sidebar-collapsed":""}`,children:[t.jsxs("aside",{className:"sidebar",children:[t.jsxs("div",{className:"sidebar-header",children:[t.jsx("div",{className:"sidebar-brand",title:"QCC Plus",children:u?"Q":"QCC Plus"}),t.jsx("button",{className:"sidebar-toggle",onClick:x,title:u?"展开":"收起",children:u?k.expand:k.collapse})]}),t.jsxs("nav",{className:"sidebar-nav",children:[t.jsxs("div",{className:"sidebar-group",children:[!u&&t.jsx("div",{className:"sidebar-group-title",children:"核心功能"}),v.map(S)]}),t.jsxs("div",{className:"sidebar-group",children:[!u&&t.jsx("div",{className:"sidebar-group-title",children:"系统管理"}),b.map(S)]})]}),t.jsxs("div",{className:"sidebar-footer",children:[t.jsxs("button",{className:"sidebar-theme-btn",onClick:m,title:`当前: ${s}`,children:[t.jsx("span",{className:"sidebar-icon",children:L}),!u&&t.jsx("span",{className:"sidebar-label",children:G})]}),t.jsxs(te,{to:"/changelog",className:"sidebar-link",title:u?"更新日志":void 0,children:[t.jsx("span",{className:"sidebar-icon",children:k.changelog}),!u&&t.jsx("span",{className:"sidebar-label",children:"更新日志"})]}),r&&!u&&t.jsxs("div",{className:"sidebar-user",children:[t.jsx("span",{className:"sidebar-user-name",children:r.name}),r.is_admin&&t.jsx("span",{className:"sidebar-user-badge",children:"管理员"})]}),t.jsxs("button",{className:"sidebar-link sidebar-logout",onClick:_,title:u?"退出登录":void 0,children:[t.jsx("span",{className:"sidebar-icon",children:k.logout}),!u&&t.jsx("span",{className:"sidebar-label",children:"退出登录"})]}),!u&&c&&t.jsx("div",{className:"sidebar-version",children:c.version.startsWith("v")?c.version:`v${c.version}`})]})]}),t.jsx("main",{className:"layout-main",children:e})]})}const K=({message:e="加载中..."})=>t.jsx("div",{className:"page-loading",children:e}),M="qcc_node_metrics_preference",F={showProxy:!0,showHealth:!0},Q=i.createContext(void 0);function st({children:e}){const[n,r]=i.useState(()=>{try{const a=localStorage.getItem(M);return a?{...F,...JSON.parse(a)}:F}catch{return F}}),c=a=>{r(d=>{const h={...d,...a};return localStorage.setItem(M,JSON.stringify(h)),h})},s=()=>{localStorage.setItem(M,JSON.stringify(F)),r(F)};return t.jsx(Q.Provider,{value:{preference:n,setPreference:c,resetToDefault:s},children:e})}function St(){const e=i.useContext(Q);return e||{preference:F,setPreference:()=>{},resetToDefault:()=>{}}}const B={list:async e=>{const n=e?new URLSearchParams(e).toString():"",r=n?`/api/settings?${n}`:"/api/settings";return l(r)},get:async e=>l(`/api/settings/${encodeURIComponent(e)}`),update:async(e,n,r,c="system")=>l(`/api/settings/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:n,version:r,scope:c})}),getVersion:async()=>(await l("/api/settings/version")).version||0},Y=i.createContext(void 0);function at({children:e}){const[n,r]=i.useState({}),[c,s]=i.useState(!0),[a,d]=i.useState(null),[h,u]=i.useState(0),p=i.useCallback(async()=>{try{const m=await B.list({scope:"system"}),v={};m.data.forEach(b=>{v[b.key]=b}),r(v),u(m.version),d(null)}catch(m){d(m?.message||"加载配置失败")}finally{s(!1)}},[]);i.useEffect(()=>{p()},[p]),i.useEffect(()=>{const m=setInterval(async()=>{try{await B.getVersion()>h&&p()}catch{}},3e4);return()=>clearInterval(m)},[h,p]);const x=async(m,v)=>{const b=n[m];if(!b)return!1;try{const S=await B.update(m,v,b.version);if(S.success)return r(L=>({...L,[m]:{...L[m],value:v,version:S.new_version}})),u(L=>S.new_version>L?S.new_version:L),!0}catch(S){throw S?.message==="version_conflict"&&p(),S}return!1},_=(m,v)=>{const b=n[m];return b?b.value:v};return t.jsx(Y.Provider,{value:{settings:n,loading:c,error:a,refresh:p,updateSetting:x,getSetting:_},children:e})}function _t(){const e=i.useContext(Y);if(!e)throw new Error("useSettings must be used within SettingsProvider");return e}const it=i.lazy(()=>j(()=>import("./Login-jXCUqavv.js"),__vite__mapDeps([0,1,2,3,4,5]))),ct=i.lazy(()=>j(()=>import("./Dashboard-DjRWEo2W.js"),__vite__mapDeps([6,1,2,7,8,3,4,9,10]))),dt=i.lazy(()=>j(()=>import("./Accounts-BY28lqtQ.js"),__vite__mapDeps([11,1,2,7,8,3,4,12,13,14]))),lt=i.lazy(()=>j(()=>import("./Nodes-BiAkwejC.js"),__vite__mapDeps([15,1,2,7,8,12,13,3,4,9,16]))),ut=i.lazy(()=>j(()=>import("./Monitor-lBYp0Dmv.js"),__vite__mapDeps([17,1,2,7,8,18,9,19,3,4,20]))),ht=i.lazy(()=>j(()=>import("./MonitorShares-CYNRVH3m.js"),__vite__mapDeps([21,1,2,7,8,12,13,3,4,9,22]))),pt=i.lazy(()=>j(()=>import("./Settings-UzuPKq99.js"),__vite__mapDeps([23,1,2,7,8,3,4,24]))),gt=i.lazy(()=>j(()=>import("./SystemSettings-yELA6wPX.js"),__vite__mapDeps([25,1,2,7,8,26]))),mt=i.lazy(()=>j(()=>import("./TunnelSettings-DVVY_-Bz.js"),__vite__mapDeps([27,1,2,7,8,3,4,28]))),ft=i.lazy(()=>j(()=>import("./Notifications-CHGZDlTl.js"),__vite__mapDeps([29,1,2,7,8,3,4,12,13,9,30]))),xt=i.lazy(()=>j(()=>import("./ChangelogPage-DNAbPC3x.js"),__vite__mapDeps([31,1,2,32]))),yt=i.lazy(()=>j(()=>import("./SharedMonitor-WqbkmKD8.js"),__vite__mapDeps([33,1,2,18,9,19,34]))),jt=i.lazy(()=>j(()=>import("./ClaudeConfig-C7WHui4Z.js"),__vite__mapDeps([35,1,2,7,8,3,4,36])));function P({children:e,adminOnly:n=!1}){const{isAuthenticated:r,loading:c,isAdmin:s}=I();return c?t.jsx(K,{message:"加载中..."}):r?n&&!s?t.jsx(O,{to:"/admin/dashboard",replace:!0}):e:t.jsx(O,{to:"/login",replace:!0})}function vt(){const{isAuthenticated:e,loading:n}=I();return n?t.jsx("div",{className:"page-loading",children:"加载中..."}):t.jsx(O,{to:e?"/admin/dashboard":"/login",replace:!0})}function bt(){return t.jsx(at,{children:t.jsx(st,{children:t.jsx(re,{children:t.jsx(i.Suspense,{fallback:t.jsx(K,{}),children:t.jsxs(oe,{children:[t.jsx(y,{path:"/",element:t.jsx(vt,{})}),t.jsx(y,{path:"/login",element:t.jsx(it,{})}),t.jsx(y,{path:"/admin/dashboard",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(ct,{})})})}),t.jsx(y,{path:"/admin/accounts",element:t.jsx(P,{adminOnly:!0,children:t.jsx(E,{children:t.jsx(dt,{})})})}),t.jsx(y,{path:"/admin/nodes",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(lt,{})})})}),t.jsx(y,{path:"/admin/claude-config",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(jt,{})})})}),t.jsx(y,{path:"/admin/monitor",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(ut,{})})})}),t.jsx(y,{path:"/admin/monitor-shares",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(ht,{})})})}),t.jsx(y,{path:"/admin/settings",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(pt,{})})})}),t.jsx(y,{path:"/settings",element:t.jsx(P,{adminOnly:!0,children:t.jsx(E,{children:t.jsx(gt,{})})})}),t.jsx(y,{path:"/admin/notifications",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(ft,{})})})}),t.jsx(y,{path:"/changelog",element:t.jsx(P,{children:t.jsx(E,{children:t.jsx(xt,{})})})}),t.jsx(y,{path:"/admin/tunnel",element:t.jsx(P,{adminOnly:!0,children:t.jsx(E,{children:t.jsx(mt,{})})})}),t.jsx(y,{path:"/monitor/share/:token",element:t.jsx(yt,{})}),t.jsx(y,{path:"*",element:t.jsx(O,{to:"/",replace:!0})})]})})})})})}const wt=document.getElementById("root");se.createRoot(wt).render(t.jsx(i.StrictMode,{children:t.jsx(rt,{children:t.jsx(He,{children:t.jsx(bt,{})})})}));export{qe as a,ot as b,A as c,St as d,_t as e,l as r,I as u};
