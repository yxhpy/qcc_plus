const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-Dgr1qKNZ.js","assets/vendor-HVpYYIdB.js","assets/charts-USIkmnH5.js","assets/Toast-D5AN34u6.js","assets/Toast-LrLVD8tt.css","assets/Login-pX2ewoYX.css","assets/Dashboard-CqbRQFAo.js","assets/Card-B8iKcX7i.js","assets/Card-DkKTq2q-.css","assets/date-DeDlRUHn.js","assets/Dashboard-DGBZKejz.css","assets/Accounts-BEg0hxzx.js","assets/useDialog-CITUSWK5.js","assets/useDialog-C2Pw8YC4.css","assets/Accounts-T17F46Yk.css","assets/Nodes-gMPYEVe0.js","assets/Nodes-BnOaK4lB.css","assets/Monitor-CcBlJ-_A.js","assets/useMonitorWebSocket-Cl5Dfd0y.js","assets/useMonitorWebSocket-BrWA1pe4.css","assets/Monitor-CRPDVZbG.css","assets/MonitorShares-CytY1aDL.js","assets/MonitorShares-DFYXKcWR.css","assets/Settings-Dc5LlCXi.js","assets/Settings-VFUETe_w.css","assets/SystemSettings-BgF2AARp.js","assets/SystemSettings-B4TbIA4N.css","assets/TunnelSettings-GvWSWvrP.js","assets/TunnelSettings-CJtnrcW4.css","assets/Notifications-BhQjyivt.js","assets/Notifications-DKv3eqqM.css","assets/ChangelogPage-BDARTNb1.js","assets/ChangelogPage-BHZn_PjU.css","assets/SharedMonitor-pYuQD30L.js","assets/SharedMonitor-DMSlU3_D.css","assets/ClaudeConfig-CUl7x7xz.js","assets/ClaudeConfig-CmRbYj_X.css","assets/Pricing-BdWdVQIi.js","assets/Pricing-BPP_n59o.css","assets/Usage-DPNEhrLQ.js","assets/Usage-D-zhP1tL.css"])))=>i.map(i=>d[i]);
import{r as i,j as t,u as ee,L as te,N as ne,B as re,R as oe,a as x,b as O,c as se}from"./vendor-HVpYYIdB.js";import"./charts-USIkmnH5.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();const ie="modulepreload",ae=function(e){return"/"+e},U={},j=function(n,r,c){let s=Promise.resolve();if(r&&r.length>0){let u=function(g){return Promise.all(g.map(y=>Promise.resolve(y).then(S=>({status:"fulfilled",value:S}),S=>({status:"rejected",reason:S}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=l?.nonce||l?.getAttribute("nonce");s=u(r.map(g=>{if(g=ae(g),g in U)return;U[g]=!0;const y=g.endsWith(".css"),S=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${S}`))return;const m=document.createElement("link");if(m.rel=y?"stylesheet":ie,y||(m.as="script"),m.crossOrigin="",m.href=g,h&&m.setAttribute("nonce",h),document.head.appendChild(m),y)return new Promise((w,_)=>{m.addEventListener("load",w),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${g}`)))})}))}function a(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return s.then(l=>{for(const h of l||[])h.status==="rejected"&&a(h.reason);return n().catch(a)})},f={"Content-Type":"application/json"};async function ce(e){const n=e.headers.get("content-type")||"";if(e.redirected||e.url.includes("/login"))throw new Error("unauthenticated");const r=await e.text();if(!n.includes("application/json"))throw new Error(r||"unexpected response");try{return JSON.parse(r)}catch{throw new Error("invalid json response")}}async function d(e,n={}){const r=await fetch(e,{credentials:"include",...n});if(!r.ok){let c=r.statusText;try{const s=await r.json();c=s.error||s.message||c}catch{}throw new Error(c||"request failed")}if(r.status!==204)return ce(r)}async function de(e,n){const r=new URLSearchParams({username:e,password:n});if(!(await fetch("/login",{method:"POST",body:r,credentials:"include",redirect:"follow"})).ok)throw new Error("登录失败");try{await W()}catch{throw new Error("账号名称或密码错误")}}async function le(){await fetch("/logout",{method:"POST",credentials:"include",redirect:"follow"})}async function W(){return(await d("/admin/api/accounts")).accounts||[]}async function ue(e){return(await d("/admin/api/accounts",{method:"POST",headers:f,body:JSON.stringify(e)})).id}async function he(e,n){await d(`/admin/api/accounts?id=${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify(n)})}async function ge(e){await d(`/admin/api/accounts?id=${encodeURIComponent(e)}`,{method:"DELETE"})}function F(e,n){if(!n)return e;const r=e.includes("?")?"&":"?";return`${e}${r}account_id=${encodeURIComponent(n)}`}async function pe(e){return(await d(F("/admin/api/nodes",e))).nodes||[]}async function me(e,n){return(await d(F("/admin/api/nodes",n),{method:"POST",headers:f,body:JSON.stringify(e)})).id}async function fe(e,n){await d(`/admin/api/nodes?id=${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify(n)})}async function xe(e){await d(`/admin/api/nodes?id=${encodeURIComponent(e)}`,{method:"DELETE"})}async function ye(e){await d("/admin/api/nodes/activate",{method:"POST",headers:f,body:JSON.stringify({id:e})})}async function je(e,n){await d(n?"/admin/api/nodes/enable":"/admin/api/nodes/disable",{method:"POST",headers:f,body:JSON.stringify({id:e})})}async function ve(e){const n=F("/api/monitor/dashboard",e);return d(n)}async function be(e,n,r,c,s){const a=new URLSearchParams;n&&a.set("from",n),r&&a.set("to",r),c&&a.set("share_token",c),s&&a.set("source",s);const l=a.toString(),h=l?`/api/nodes/${encodeURIComponent(e)}/health-history?${l}`:`/api/nodes/${encodeURIComponent(e)}/health-history`;return d(h)}async function we(e){const n=await d("/api/monitor/shares",{method:"POST",headers:f,body:JSON.stringify(e)});return{id:n.id,token:n.token,share_url:n.share_url,expire_at:n.expire_at??void 0,created_at:n.created_at,account_id:n.account_id||e.account_id||"",created_by:n.created_by||"",revoked:!1,revoked_at:void 0}}async function _e(e,n=20,r=0){const c=new URLSearchParams;e&&c.set("account_id",e),c.set("limit",String(n)),c.set("offset",String(r));const s=c.toString(),a=s?`/api/monitor/shares?${s}`:"/api/monitor/shares",l=await d(a);return{shares:l.shares||[],total:l.total}}async function Ee(e){await d(`/api/monitor/shares/${encodeURIComponent(e)}`,{method:"DELETE"})}async function Pe(e){return d(`/api/monitor/share/${encodeURIComponent(e)}`)}async function Se(e){return d(F("/admin/api/config",e))}async function ke(e,n){await d(F("/admin/api/config",n),{method:"PUT",headers:f,body:JSON.stringify(e)})}async function Le(){return d("/admin/api/tunnel")}async function Ce(e){return d("/admin/api/tunnel",{method:"PUT",headers:f,body:JSON.stringify(e)})}async function Ne(){return d("/admin/api/tunnel/start",{method:"POST",headers:f})}async function Fe(){return d("/admin/api/tunnel/stop",{method:"POST",headers:f})}async function Te(){return(await d("/admin/api/tunnel/zones")).zones||[]}async function Ae(){return d("/version")}async function Oe(){const e=await fetch("/changelog",{credentials:"include"}),n=await e.text();if(e.redirected||e.url.includes("/login"))throw new Error("unauthenticated");if(!e.ok)throw new Error(n||"加载更新日志失败");return n}async function Re(){try{const e=await d("/api/notification/channels");return Array.isArray(e?.channels)?e.channels:[]}catch(e){return console.error("Failed to fetch notification channels:",e),[]}}async function Me(e){return d("/api/notification/channels",{method:"POST",headers:f,body:JSON.stringify(e)})}async function Ie(e,n){await d(`/api/notification/channels/${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify(n)})}async function Be(e){await d(`/api/notification/channels/${encodeURIComponent(e)}`,{method:"DELETE"})}async function Ue(e){const n=e?`/api/notification/subscriptions?channel_id=${encodeURIComponent(e)}`:"/api/notification/subscriptions";try{const r=await d(n);return Array.isArray(r?.subscriptions)?r.subscriptions:[]}catch(r){return console.error("Failed to fetch subscriptions:",r),[]}}async function De(e){await d("/api/notification/subscriptions",{method:"POST",headers:f,body:JSON.stringify(e)})}async function $e(e,n){await d(`/api/notification/subscriptions/${encodeURIComponent(e)}`,{method:"PUT",headers:f,body:JSON.stringify({enabled:n})})}async function Ve(e){await d(`/api/notification/subscriptions/${encodeURIComponent(e)}`,{method:"DELETE"})}async function Je(){try{const e=await d("/api/notification/event-types");return Array.isArray(e?.event_types)?e.event_types:[]}catch(e){return console.error("Failed to fetch event types:",e),[]}}async function We(e){await d("/api/notification/test",{method:"POST",headers:f,body:JSON.stringify(e)})}async function ze(e){const n=new URLSearchParams;e?.proxy_url&&n.set("proxy_url",e.proxy_url),e?.api_key&&n.set("api_key",e.api_key),e?.model&&n.set("model",e.model),e?.allow?.forEach(s=>{const a=s.trim();a&&n.append("allow",a)}),e?.deny?.forEach(s=>{const a=s.trim();a&&n.append("deny",a)});const r=n.toString(),c=r?`/api/claude-config/template?${r}`:"/api/claude-config/template";return d(c)}async function He(e=!1){return(await d(e?"/api/pricing?active_only=true":"/api/pricing")).pricing||[]}async function qe(e){return d(`/api/pricing?id=${encodeURIComponent(e)}`)}async function Ze(e){return(await d("/api/pricing",{method:"POST",headers:f,body:JSON.stringify(e)})).model_id}async function Ke(e){await d(`/api/pricing?id=${encodeURIComponent(e)}`,{method:"DELETE"})}async function Qe(e={}){const n=new URLSearchParams;e.account_id&&n.set("account_id",e.account_id),e.node_id&&n.set("node_id",e.node_id),e.model_id&&n.set("model_id",e.model_id),e.from&&n.set("from",e.from),e.to&&n.set("to",e.to),e.limit&&n.set("limit",String(e.limit)),e.offset&&n.set("offset",String(e.offset));const r=n.toString(),c=r?`/api/usage/logs?${r}`:"/api/usage/logs";return d(c)}async function Ye(e={}){const n=new URLSearchParams;e.account_id&&n.set("account_id",e.account_id),e.node_id&&n.set("node_id",e.node_id),e.model_id&&n.set("model_id",e.model_id),e.from&&n.set("from",e.from),e.to&&n.set("to",e.to),e.group_by&&n.set("group_by",e.group_by);const r=n.toString(),c=r?`/api/usage/summary?${r}`:"/api/usage/summary",s=await d(c);return"summaries"in s?s.summaries:s}async function Ge(e=365){await d("/api/usage/cleanup",{method:"POST",headers:f,body:JSON.stringify({retention_days:e})})}async function Xe(){return(await d("/api/envvars/categories")).data||[]}async function et(e){const n=e?`/api/envvars?category=${encodeURIComponent(e)}`:"/api/envvars";return(await d(n)).data||[]}const A={login:de,logout:le,getAccounts:W,createAccount:ue,updateAccount:he,deleteAccount:ge,getNodes:pe,createNode:me,updateNode:fe,deleteNode:xe,activateNode:ye,toggleNode:je,getMonitorDashboard:ve,getHealthHistory:be,createMonitorShare:we,getMonitorShares:_e,revokeMonitorShare:Ee,getSharedMonitor:Pe,getConfig:Se,updateConfig:ke,getTunnel:Le,saveTunnel:Ce,startTunnel:Ne,stopTunnel:Fe,listZones:Te,getVersion:Ae,getChangelog:Oe,getNotificationChannels:Re,createNotificationChannel:Me,updateNotificationChannel:Ie,deleteNotificationChannel:Be,getNotificationSubscriptions:Ue,createNotificationSubscriptions:De,updateNotificationSubscription:$e,deleteNotificationSubscription:Ve,getEventTypes:Je,testNotification:We,getClaudeConfigTemplate:ze,getPricingList:He,getPricing:qe,savePricing:Ze,deletePricing:Ke,getUsageLogs:Qe,getUsageSummary:Ye,cleanupUsageLogs:Ge,getEnvVarCategories:Xe,getEnvVars:et},z=i.createContext(void 0),T="claude-proxy-auth";function tt({children:e}){const[n,r]=i.useState(null),[c,s]=i.useState(!0),a=i.useCallback(async()=>{s(!0);try{const y=(await A.getAccounts())[0]||null;r(y),y?localStorage.setItem(T,"true"):localStorage.removeItem(T)}catch{r(null),localStorage.removeItem(T)}finally{s(!1)}},[]);i.useEffect(()=>{a()},[a]);const l=i.useCallback(async(g,y)=>{await A.login(g,y),await a()},[a]),h=i.useCallback(async()=>{await A.logout(),localStorage.removeItem(T),r(null)},[]),u=i.useMemo(()=>({user:n,loading:c,isAuthenticated:!!n,isAdmin:!!n?.is_admin,login:l,logout:h,refresh:a}),[n,c,l,h,a]);return t.jsx(z.Provider,{value:u,children:e})}function B(){const e=i.useContext(z);if(!e)throw new Error("useAuth must be used within AuthProvider");return e}function nt(){const[e,n]=i.useState(null),[r,c]=i.useState(!0),[s,a]=i.useState(null);return i.useEffect(()=>{let l=!1;return(async()=>{c(!0),a(null);try{const u=await A.getVersion();l||n(u)}catch(u){l||a(u instanceof Error?u:new Error("加载版本信息失败"))}finally{l||c(!1)}})(),()=>{l=!0}},[]),{version:e,loading:r,error:s}}const rt={50:"#F8FAFC",100:"#F1F5F9",200:"#E2E8F0",300:"#CBD5E1",400:"#94A3B8",500:"#64748B",600:"#475569",700:"#334155",800:"#1E293B",900:"#0F172A"},H={50:"#EFF6FF",100:"#DBEAFE",200:"#BFDBFE",300:"#93C5FD",400:"#60A5FA",500:"#3B82F6",600:"#2563EB",700:"#1D4ED8",800:"#1E40AF",900:"#1E3A8A"},ot={50:"#ECFDF3",100:"#D1FADF",200:"#A6F4C5",700:"#027A48",900:"#054F31"},st={50:"#FFFBEB",100:"#FEF3C7",200:"#FDE68A",700:"#B45309",900:"#78350F"},it={50:"#FEF2F2",100:"#FEE2E2",200:"#FECACA",700:"#B91C1C",900:"#7F1D1D"},at={...H},o={colorPalette:{gray:rt,primary:H,success:ot,warning:st,danger:it,info:at},typography:{fontSize:{base:"14px"},fontWeight:{semibold:600}},spacing:{2:"8px",3:"12px",4:"16px"},radius:{md:"4px",lg:"6px"},shadow:{none:"none",sm:"0 1px 2px rgba(15, 23, 42, 0.08), 0 1px 1px rgba(15, 23, 42, 0.04)",md:"0 4px 8px rgba(15, 23, 42, 0.12), 0 2px 4px rgba(15, 23, 42, 0.08)",lg:"0 12px 24px rgba(15, 23, 42, 0.16), 0 6px 12px rgba(15, 23, 42, 0.12)"},transition:{duration:{normal:"200ms"}},easing:{easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)"}},R=e=>`0 0 0 3px ${e}`,q=(e,n)=>{const r=n==="light",c={bg:o.colorPalette.primary[600],text:"#FFFFFF",border:o.colorPalette.primary[600],hoverBg:o.colorPalette.primary[700],activeBg:o.colorPalette.primary[800],disabledBg:r?o.colorPalette.gray[200]:o.colorPalette.gray[800],disabledText:e.text.disabled,focusRing:R(e.interaction.focus)},s={bg:e.bg.card,text:e.text.primary,border:e.border.default,hoverBg:r?o.colorPalette.gray[100]:"rgba(255, 255, 255, 0.04)",activeBg:r?o.colorPalette.gray[200]:"rgba(255, 255, 255, 0.08)",disabledBg:r?o.colorPalette.gray[100]:o.colorPalette.gray[800],disabledText:e.text.disabled,focusRing:R(e.interaction.focus)},a={bg:"transparent",text:o.colorPalette.primary[600],border:"transparent",hoverBg:r?o.colorPalette.primary[50]:"rgba(59, 130, 246, 0.12)",activeBg:r?o.colorPalette.primary[100]:"rgba(59, 130, 246, 0.16)",disabledBg:"transparent",disabledText:e.text.disabled,focusRing:R(e.interaction.focus)};return{button:{height:"40px",paddingX:o.spacing[3],paddingY:o.spacing[2],gap:o.spacing[2],radius:o.radius.md,typography:{size:o.typography.fontSize.base,weight:o.typography.fontWeight.semibold},variants:{primary:c,secondary:s,ghost:a},transition:{duration:o.transition.duration.normal,easing:o.easing.easeInOut}},card:{bg:e.bg.card,text:e.text.primary,border:e.border.default,shadow:r?o.shadow.sm:o.shadow.md,radius:o.radius.lg,padding:o.spacing[4],elevated:{bg:e.bg.elevated,shadow:r?o.shadow.md:o.shadow.lg}},sidebar:{width:{collapsed:"72px",expanded:"256px"},bg:r?"#FFFFFF":o.colorPalette.gray[900],text:e.text.primary,border:e.border.default,activeItemBg:r?o.colorPalette.primary[50]:"rgba(59, 130, 246, 0.16)",activeItemText:r?o.colorPalette.primary[700]:"#FFFFFF"},table:{headerBg:e.bg.elevated,headerText:e.text.secondary,rowHoverBg:e.interaction.hover,rowActiveBg:e.interaction.active,border:e.border.default,divider:e.divider,radius:o.radius.md,padding:o.spacing[3]},input:{bg:e.bg.card,text:e.text.primary,placeholder:e.text.muted,border:e.border.default,hoverBorder:e.border.default,focusBorder:e.border.focus,disabledBg:r?o.colorPalette.gray[100]:o.colorPalette.gray[800],disabledText:e.text.disabled,radius:o.radius.md,shadow:r?o.shadow.sm:o.shadow.none}}},ct="rgba(15, 23, 42, 0.48)",dt="rgba(0, 0, 0, 0.55)",L=(e,n)=>n==="light"?{bg:e[50],text:e[700],border:e[200]}:{bg:e[900],text:e[100],border:e[700]},lt={text:{primary:o.colorPalette.gray[900],secondary:o.colorPalette.gray[700],muted:o.colorPalette.gray[500],disabled:o.colorPalette.gray[400],inverse:"#FFFFFF"},bg:{page:o.colorPalette.gray[50],card:"#FFFFFF",elevated:"#FFFFFF",overlay:ct},state:{success:L(o.colorPalette.success,"light"),info:L(o.colorPalette.info,"light"),warning:L(o.colorPalette.warning,"light"),danger:L(o.colorPalette.danger,"light")},interaction:{hover:o.colorPalette.primary[50],active:o.colorPalette.primary[100],focus:o.colorPalette.primary[300]},divider:o.colorPalette.gray[200],border:{default:o.colorPalette.gray[300],focus:o.colorPalette.primary[500]}},ut={text:{primary:o.colorPalette.gray[50],secondary:o.colorPalette.gray[300],muted:o.colorPalette.gray[500],disabled:o.colorPalette.gray[600],inverse:o.colorPalette.gray[900]},bg:{page:"#0B1220",card:"#0F172A",elevated:"#111827",overlay:dt},state:{success:L(o.colorPalette.success,"dark"),info:L(o.colorPalette.info,"dark"),warning:L(o.colorPalette.warning,"dark"),danger:L(o.colorPalette.danger,"dark")},interaction:{hover:"rgba(59, 130, 246, 0.12)",active:"rgba(59, 130, 246, 0.18)",focus:o.colorPalette.primary[400]},divider:o.colorPalette.gray[700],border:{default:o.colorPalette.gray[700],focus:o.colorPalette.primary[400]}};q(lt,"light");q(ut,"dark");const Z=i.createContext(void 0),D="qcc-theme";function $(){return typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function ht({children:e}){const[n,r]=i.useState(()=>{if(typeof window<"u"){const l=localStorage.getItem(D);if(l&&["light","dark","system"].includes(l))return l}return"system"}),[c,s]=i.useState(()=>n==="system"?$():n);i.useEffect(()=>{if(n!=="system")return;const l=window.matchMedia("(prefers-color-scheme: dark)"),h=u=>{s(u.matches?"dark":"light")};return l.addEventListener("change",h),()=>l.removeEventListener("change",h)},[n]),i.useEffect(()=>{s(n==="system"?$():n)},[n]),i.useEffect(()=>{document.documentElement.setAttribute("data-theme",c)},[c]);const a=i.useCallback(l=>{r(l),localStorage.setItem(D,l)},[]);return t.jsx(Z.Provider,{value:{theme:n,resolvedTheme:c,setTheme:a},children:e})}function gt(){const e=i.useContext(Z);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e}const k={dashboard:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("rect",{x:"3",y:"3",width:"6",height:"6",rx:"1.2"}),t.jsx("rect",{x:"11",y:"3",width:"6",height:"4.5",rx:"1.2"}),t.jsx("rect",{x:"3",y:"11",width:"6",height:"6",rx:"1.2"}),t.jsx("rect",{x:"11",y:"9.5",width:"6",height:"7.5",rx:"1.2"})]}),monitor:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("rect",{x:"2.75",y:"3.5",width:"14.5",height:"9.5",rx:"1.3"}),t.jsx("path",{d:"M5.5 11.5 7.3 8l1.9 4 1.6-4.7 1.8 4.6 1.4-3"}),t.jsx("path",{d:"M8 16.5h4"}),t.jsx("path",{d:"M10 13v3.5"})]}),magic:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"m11 2.5-4.8 7.7h3.2L7.8 17.5l6.2-9.7H11l.8-5.3Z"}),t.jsx("path",{d:"m4 15.6 2-2"}),t.jsx("path",{d:"m14.5 5.5 1.5-1.5"}),t.jsx("path",{d:"m5.2 5.8.6-2.3"}),t.jsx("path",{d:"m15 14.2 1.8.3"})]}),accounts:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M10 10.25a3.25 3.25 0 1 0-3.25-3.25A3.25 3.25 0 0 0 10 10.25Z"}),t.jsx("path",{d:"M4.5 15.75c.8-2.05 2.85-3.25 5.5-3.25s4.7 1.2 5.5 3.25"})]}),nodes:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"5",cy:"5",r:"2.25"}),t.jsx("circle",{cx:"15",cy:"6.5",r:"2.25"}),t.jsx("circle",{cx:"10",cy:"15",r:"2.25"}),t.jsx("path",{d:"M6.9 6.1 13.2 6.4"}),t.jsx("path",{d:"M6.2 6.9 8.8 13.4"}),t.jsx("path",{d:"M13.3 8.4 10.9 13"})]}),share:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"m15.5 5-5.2 3-5.3-3"}),t.jsx("circle",{cx:"15.5",cy:"5",r:"2"}),t.jsx("circle",{cx:"4.5",cy:"10",r:"2"}),t.jsx("circle",{cx:"15.5",cy:"15",r:"2"}),t.jsx("path",{d:"m6.4 11.1 3.9 2.3"}),t.jsx("path",{d:"m11 7.9 3.6 1.9"})]}),settings:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"10",cy:"10",r:"3"}),t.jsx("path",{d:"M10 3.5v1.2"}),t.jsx("path",{d:"M10 15.3v1.2"}),t.jsx("path",{d:"m4.3 5.2.9.7"}),t.jsx("path",{d:"m14.8 14.1.9.7"}),t.jsx("path",{d:"M3.5 10h1.2"}),t.jsx("path",{d:"M15.3 10h1.2"}),t.jsx("path",{d:"m4.3 14.8.9-.7"}),t.jsx("path",{d:"m14.8 5.9.9-.7"})]}),notifications:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M6.5 8.5a3.5 3.5 0 0 1 7 0c0 3.25 1.15 4.5 2 5H4.5c.85-.5 2-1.75 2-5Z"}),t.jsx("path",{d:"M9 15.5c.25.6.85 1 1.5 1s1.25-.4 1.5-1"})]}),tunnel:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M6.2 11.5A3.5 3.5 0 0 1 6.5 4a3.7 3.7 0 0 1 1.9.52 4 4 0 0 1 6 3.48v.5a3 3 0 0 1-1.2 5.8H11"}),t.jsx("path",{d:"M11.2 9.5 8.8 12l2.4 2.5"})]}),changelog:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M6.5 3.5h5.8a1.7 1.7 0 0 1 1.2.5l2 2a1.7 1.7 0 0 1 .5 1.2v7.1a1.7 1.7 0 0 1-1.7 1.7H6.5A1.7 1.7 0 0 1 4.8 14V5.2A1.7 1.7 0 0 1 6.5 3.5Z"}),t.jsx("path",{d:"M13 3.6V6a1 1 0 0 0 1 1h2.3"}),t.jsx("path",{d:"M7.5 9.5h5"}),t.jsx("path",{d:"M7.5 12.5h3.5"})]}),pricing:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M10 3v14"}),t.jsx("path",{d:"M13.5 6H8.25a2.25 2.25 0 0 0 0 4.5h3.5a2.25 2.25 0 0 1 0 4.5H6"}),t.jsx("path",{d:"M8 3h4"}),t.jsx("path",{d:"M8 17h4"})]}),usage:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 17V7l4-4 6 6 4-4v12"}),t.jsx("path",{d:"M3 13l4-4 6 6 4-4"})]}),collapse:t.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"m11.5 5.5-4 4 4 4"})}),expand:t.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"m8.5 14.5 4-4-4-4"})}),logout:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M11.5 5.5V4.2A1.7 1.7 0 0 0 9.8 2.5H5.7A1.7 1.7 0 0 0 4 4.2v11.6a1.7 1.7 0 0 0 1.7 1.7h4.1a1.7 1.7 0 0 0 1.7-1.7v-1.3"}),t.jsx("path",{d:"M8.5 10h7"}),t.jsx("path",{d:"m13.5 7 3 3-3 3"})]}),sun:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"10",cy:"10",r:"3.25"}),t.jsx("path",{d:"M10 3.5v1.5M10 15v1.5M4.5 10H3M17 10h-1.5M5.5 5.5 4.4 4.4M15.6 15.6 14.5 14.5M5.5 14.5 4.4 15.6M15.6 4.4 14.5 5.5"})]}),moon:t.jsx("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M15.5 11.6a5.8 5.8 0 1 1-7.1-7.1 5.2 5.2 0 0 0 7.1 7.1Z"})}),system:t.jsxs("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"10",cy:"10",r:"5.5"}),t.jsx("path",{d:"M4.5 10h11"}),t.jsx("path",{d:"M10 4.5c1.6 2.6 1.6 8.4 0 11"})]})},V=[{path:"/admin/dashboard",label:"仪表盘",icon:"dashboard",group:"core"},{path:"/admin/claude-config",label:"快速配置",icon:"magic",group:"core"},{path:"/admin/monitor",label:"监控大屏",icon:"monitor",group:"core"},{path:"/admin/nodes",label:"节点管理",icon:"nodes",group:"core"},{path:"/admin/usage",label:"使用统计",icon:"usage",group:"core"},{path:"/admin/accounts",label:"账号管理",icon:"accounts",adminOnly:!0,group:"system"},{path:"/admin/pricing",label:"模型定价",icon:"pricing",adminOnly:!0,group:"system"},{path:"/admin/monitor-shares",label:"分享链接",icon:"share",group:"system"},{path:"/admin/notifications",label:"通知管理",icon:"notifications",group:"system"},{path:"/settings",label:"系统设置",icon:"settings",adminOnly:!0,group:"system"},{path:"/admin/tunnel",label:"隧道设置",icon:"tunnel",adminOnly:!0,group:"system"}],J="qcc-sidebar-collapsed";function v({children:e}){const{logout:n,user:r}=B(),{version:c}=nt(),{theme:s,setTheme:a,resolvedTheme:l}=gt(),h=ee(),[u,g]=i.useState(()=>typeof window>"u"?!1:localStorage.getItem(J)==="true");i.useEffect(()=>{const p=window.matchMedia("(max-width: 768px)"),E=X=>{X.matches&&g(!0)};return p.matches&&g(!0),p.addEventListener?p.addEventListener("change",E):p.addListener(E),()=>{p.removeEventListener?p.removeEventListener("change",E):p.removeListener(E)}},[]);const y=i.useCallback(()=>{g(p=>{const E=!p;return localStorage.setItem(J,String(E)),E})},[]),S=async()=>{try{await n(),h("/login",{replace:!0})}catch{h("/login",{replace:!0})}},m=()=>{const p=["light","dark","system"],E=p.indexOf(s);a(p[(E+1)%p.length])},w=V.filter(p=>p.group==="core"),_=V.filter(p=>p.group==="system"),P=p=>p.adminOnly&&!r?.is_admin?null:t.jsxs(ne,{to:p.path,className:({isActive:E})=>`sidebar-link ${E?"active":""}`,title:u?p.label:void 0,children:[t.jsx("span",{className:"sidebar-icon",children:k[p.icon]}),!u&&t.jsx("span",{className:"sidebar-label",children:p.label})]},p.path),C=s==="system"?k.system:l==="dark"?k.moon:k.sun,G=s==="system"?"跟随系统":l==="dark"?"深色":"浅色";return t.jsxs("div",{className:`layout ${u?"sidebar-collapsed":""}`,children:[t.jsxs("aside",{className:"sidebar",children:[t.jsxs("div",{className:"sidebar-header",children:[t.jsx("div",{className:"sidebar-brand",title:"QCC Plus",children:u?"Q":"QCC Plus"}),t.jsx("button",{className:"sidebar-toggle",onClick:y,title:u?"展开":"收起",children:u?k.expand:k.collapse})]}),t.jsxs("nav",{className:"sidebar-nav",children:[t.jsxs("div",{className:"sidebar-group",children:[!u&&t.jsx("div",{className:"sidebar-group-title",children:"核心功能"}),w.map(P)]}),t.jsxs("div",{className:"sidebar-group",children:[!u&&t.jsx("div",{className:"sidebar-group-title",children:"系统管理"}),_.map(P)]})]}),t.jsxs("div",{className:"sidebar-footer",children:[t.jsxs("button",{className:"sidebar-theme-btn",onClick:m,title:`当前: ${s}`,children:[t.jsx("span",{className:"sidebar-icon",children:C}),!u&&t.jsx("span",{className:"sidebar-label",children:G})]}),t.jsxs(te,{to:"/changelog",className:"sidebar-link",title:u?"更新日志":void 0,children:[t.jsx("span",{className:"sidebar-icon",children:k.changelog}),!u&&t.jsx("span",{className:"sidebar-label",children:"更新日志"})]}),r&&!u&&t.jsxs("div",{className:"sidebar-user",children:[t.jsx("span",{className:"sidebar-user-name",children:r.name}),r.is_admin&&t.jsx("span",{className:"sidebar-user-badge",children:"管理员"})]}),t.jsxs("button",{className:"sidebar-link sidebar-logout",onClick:S,title:u?"退出登录":void 0,children:[t.jsx("span",{className:"sidebar-icon",children:k.logout}),!u&&t.jsx("span",{className:"sidebar-label",children:"退出登录"})]}),!u&&c&&t.jsx("div",{className:"sidebar-version",children:c.version.startsWith("v")?c.version:`v${c.version}`})]})]}),t.jsx("main",{className:"layout-main",children:e})]})}const K=({message:e="加载中..."})=>t.jsx("div",{className:"page-loading",children:e}),M="qcc_node_metrics_preference",N={showProxy:!0,showHealth:!0},Q=i.createContext(void 0);function pt({children:e}){const[n,r]=i.useState(()=>{try{const a=localStorage.getItem(M);return a?{...N,...JSON.parse(a)}:N}catch{return N}}),c=a=>{r(l=>{const h={...l,...a};return localStorage.setItem(M,JSON.stringify(h)),h})},s=()=>{localStorage.setItem(M,JSON.stringify(N)),r(N)};return t.jsx(Q.Provider,{value:{preference:n,setPreference:c,resetToDefault:s},children:e})}function Mt(){const e=i.useContext(Q);return e||{preference:N,setPreference:()=>{},resetToDefault:()=>{}}}const I={list:async e=>{const n=e?new URLSearchParams(e).toString():"",r=n?`/api/settings?${n}`:"/api/settings";return d(r)},get:async e=>d(`/api/settings/${encodeURIComponent(e)}`),update:async(e,n,r,c="system")=>d(`/api/settings/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:n,version:r,scope:c})}),getVersion:async()=>(await d("/api/settings/version")).version||0},Y=i.createContext(void 0);function mt({children:e}){const[n,r]=i.useState({}),[c,s]=i.useState(!0),[a,l]=i.useState(null),[h,u]=i.useState(0),g=i.useCallback(async()=>{try{const m=await I.list({scope:"system"}),w={};m.data.forEach(_=>{w[_.key]=_}),r(w),u(m.version),l(null)}catch(m){l(m?.message||"加载配置失败")}finally{s(!1)}},[]);i.useEffect(()=>{g()},[g]),i.useEffect(()=>{const m=setInterval(async()=>{try{await I.getVersion()>h&&g()}catch{}},3e4);return()=>clearInterval(m)},[h,g]);const y=async(m,w)=>{const _=n[m];if(!_)return!1;try{const P=await I.update(m,w,_.version);if(P.success)return r(C=>({...C,[m]:{...C[m],value:w,version:P.new_version}})),u(C=>P.new_version>C?P.new_version:C),!0}catch(P){throw P?.message==="version_conflict"&&g(),P}return!1},S=(m,w)=>{const _=n[m];return _?_.value:w};return t.jsx(Y.Provider,{value:{settings:n,loading:c,error:a,refresh:g,updateSetting:y,getSetting:S},children:e})}function It(){const e=i.useContext(Y);if(!e)throw new Error("useSettings must be used within SettingsProvider");return e}const ft=i.lazy(()=>j(()=>import("./Login-Dgr1qKNZ.js"),__vite__mapDeps([0,1,2,3,4,5]))),xt=i.lazy(()=>j(()=>import("./Dashboard-CqbRQFAo.js"),__vite__mapDeps([6,1,2,7,8,3,4,9,10]))),yt=i.lazy(()=>j(()=>import("./Accounts-BEg0hxzx.js"),__vite__mapDeps([11,1,2,7,8,3,4,12,13,14]))),jt=i.lazy(()=>j(()=>import("./Nodes-gMPYEVe0.js"),__vite__mapDeps([15,1,2,7,8,12,13,3,4,9,16]))),vt=i.lazy(()=>j(()=>import("./Monitor-CcBlJ-_A.js"),__vite__mapDeps([17,1,2,7,8,18,9,19,3,4,20]))),bt=i.lazy(()=>j(()=>import("./MonitorShares-CytY1aDL.js"),__vite__mapDeps([21,1,2,7,8,12,13,3,4,9,22]))),wt=i.lazy(()=>j(()=>import("./Settings-Dc5LlCXi.js"),__vite__mapDeps([23,1,2,7,8,3,4,24]))),_t=i.lazy(()=>j(()=>import("./SystemSettings-BgF2AARp.js"),__vite__mapDeps([25,1,2,7,8,26]))),Et=i.lazy(()=>j(()=>import("./TunnelSettings-GvWSWvrP.js"),__vite__mapDeps([27,1,2,7,8,3,4,28]))),Pt=i.lazy(()=>j(()=>import("./Notifications-BhQjyivt.js"),__vite__mapDeps([29,1,2,7,8,3,4,12,13,9,30]))),St=i.lazy(()=>j(()=>import("./ChangelogPage-BDARTNb1.js"),__vite__mapDeps([31,1,2,32]))),kt=i.lazy(()=>j(()=>import("./SharedMonitor-pYuQD30L.js"),__vite__mapDeps([33,1,2,18,9,19,34]))),Lt=i.lazy(()=>j(()=>import("./ClaudeConfig-CUl7x7xz.js"),__vite__mapDeps([35,1,2,7,8,3,4,36]))),Ct=i.lazy(()=>j(()=>import("./Pricing-BdWdVQIi.js"),__vite__mapDeps([37,1,2,7,8,3,4,38]))),Nt=i.lazy(()=>j(()=>import("./Usage-DPNEhrLQ.js"),__vite__mapDeps([39,1,2,7,8,3,4,40])));function b({children:e,adminOnly:n=!1}){const{isAuthenticated:r,loading:c,isAdmin:s}=B();return c?t.jsx(K,{message:"加载中..."}):r?n&&!s?t.jsx(O,{to:"/admin/dashboard",replace:!0}):e:t.jsx(O,{to:"/login",replace:!0})}function Ft(){const{isAuthenticated:e,loading:n}=B();return n?t.jsx("div",{className:"page-loading",children:"加载中..."}):t.jsx(O,{to:e?"/admin/dashboard":"/login",replace:!0})}function Tt(){return t.jsx(mt,{children:t.jsx(pt,{children:t.jsx(re,{children:t.jsx(i.Suspense,{fallback:t.jsx(K,{}),children:t.jsxs(oe,{children:[t.jsx(x,{path:"/",element:t.jsx(Ft,{})}),t.jsx(x,{path:"/login",element:t.jsx(ft,{})}),t.jsx(x,{path:"/admin/dashboard",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(xt,{})})})}),t.jsx(x,{path:"/admin/accounts",element:t.jsx(b,{adminOnly:!0,children:t.jsx(v,{children:t.jsx(yt,{})})})}),t.jsx(x,{path:"/admin/nodes",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(jt,{})})})}),t.jsx(x,{path:"/admin/claude-config",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(Lt,{})})})}),t.jsx(x,{path:"/admin/monitor",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(vt,{})})})}),t.jsx(x,{path:"/admin/monitor-shares",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(bt,{})})})}),t.jsx(x,{path:"/admin/settings",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(wt,{})})})}),t.jsx(x,{path:"/settings",element:t.jsx(b,{adminOnly:!0,children:t.jsx(v,{children:t.jsx(_t,{})})})}),t.jsx(x,{path:"/admin/notifications",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(Pt,{})})})}),t.jsx(x,{path:"/changelog",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(St,{})})})}),t.jsx(x,{path:"/admin/tunnel",element:t.jsx(b,{adminOnly:!0,children:t.jsx(v,{children:t.jsx(Et,{})})})}),t.jsx(x,{path:"/admin/pricing",element:t.jsx(b,{adminOnly:!0,children:t.jsx(v,{children:t.jsx(Ct,{})})})}),t.jsx(x,{path:"/admin/usage",element:t.jsx(b,{children:t.jsx(v,{children:t.jsx(Nt,{})})})}),t.jsx(x,{path:"/monitor/share/:token",element:t.jsx(kt,{})}),t.jsx(x,{path:"*",element:t.jsx(O,{to:"/",replace:!0})})]})})})})})}const At=document.getElementById("root");se.createRoot(At).render(t.jsx(i.StrictMode,{children:t.jsx(ht,{children:t.jsx(tt,{children:t.jsx(Tt,{})})})}));export{nt as a,gt as b,A as c,Mt as d,It as e,d as r,B as u};
