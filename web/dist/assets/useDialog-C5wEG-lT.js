import{r as f,m as j,j as e,c as g}from"./vendor-HVpYYIdB.js";const x='a[href], button:not([disabled]), textarea, input, select, details,[tabindex]:not([tabindex="-1"])';function N({open:o,title:l,children:r,footer:s,onClose:t,closeOnMask:u=!0,size:i="md"}){const c=f.useRef(null),d=f.useRef(null);if(f.useEffect(()=>{if(!o)return;const m=document.activeElement,E=document.body.style.overflow;document.body.style.overflow="hidden";const b=d.current?.querySelector('[data-autofocus="true"]');if(b)b.focus();else{const n=d.current?.querySelectorAll(x)?.[0];n?n.focus():d.current?.focus()}const y=a=>{if(a.key==="Escape"&&t?.(),a.key==="Tab"){const n=d.current?.querySelectorAll(x);if(!n||n.length===0)return;const v=n[0],h=n[n.length-1];a.shiftKey&&document.activeElement===v?(h.focus(),a.preventDefault()):!a.shiftKey&&document.activeElement===h&&(v.focus(),a.preventDefault())}};return document.addEventListener("keydown",y),()=>{document.removeEventListener("keydown",y),document.body.style.overflow=E,m?.focus()}},[o,t]),!o)return null;const p=e.jsx("div",{className:"modal-overlay",ref:c,onMouseDown:m=>{u&&m.target===c.current&&t?.()},children:e.jsxs("div",{className:`modal modal-${i}`,role:"dialog","aria-modal":"true","aria-label":l||"对话框",ref:d,tabIndex:-1,children:[l&&e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{children:l}),e.jsx("button",{className:"btn ghost",type:"button",onClick:t,"aria-label":"关闭",children:"X"})]}),e.jsx("div",{className:"modal-body",children:r}),s&&e.jsx("div",{className:"modal-footer",children:s})]})});return j.createPortal(p,document.body)}function w({open:o,title:l="确认操作",message:r,confirmText:s="确认",cancelText:t="取消",closeOnMask:u=!0,onConfirm:i,onCancel:c}){return e.jsx(N,{open:o,title:l,closeOnMask:u,onClose:c,footer:e.jsxs("div",{className:"dialog-actions",children:[e.jsx("button",{className:"btn ghost",type:"button",onClick:c,children:t}),e.jsx("button",{className:"btn primary",type:"button",onClick:i,children:s})]}),children:typeof r=="string"?e.jsx("p",{className:"dialog-message",children:r}):r})}function k(){const o=f.useRef(!1);return{confirm:f.useCallback(r=>new Promise(s=>{if(o.current){s(!1);return}o.current=!0;const t=document.createElement("div");document.body.appendChild(t);const u=g.createRoot(t),i=c=>{o.current=!1,u.unmount(),t.remove(),s(c)};u.render(e.jsx(w,{open:!0,...r,onConfirm:()=>i(!0),onCancel:()=>i(!1)}))}),[])}}export{N as M,k as u};
